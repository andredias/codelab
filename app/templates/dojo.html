{% extends "base.html" %}
{% block title %}CodeBox | Dojo{% endblock %}
{% block head %}
    <script src="//cdn.jsdelivr.net/ace/latest/min/ace.js"></script>
    <script src="{{ url_for('static', filename='js/editor.js') }}"></script>
    <script src="{{ url_for('static', filename='js/codebox.js') }}"></script>
    <script>
        var lint_data = {{ lint_data | tojson | safe }};
    </script>
{% endblock %}
{% block body %}
<body id="dojo">
    <header>
        <h1><a href="/">Code Lab</a></h1>
        <button name="run"><i class="icon-play3"></i> <span>Run</span></button>
    </header>
    <article class="content">
        <aside class="panel_1"></aside>
        <div class="central">
            <section class="editor">
                <div id="editor" data-ace-theme="{{ config['ACE_THEME'] }}">{{ source }}</div>
                <footer>
                    <div class="menu" id="a-language">
                        <span>{{ language }}</span>
                        <ul class="dropdown">
                        {% for name, mode in config['LANGUAGES'].items()|sort %}
                            <li data-ace-mode="{{ mode }}">{{ name }}</li>
                        {% endfor %}
                        </ul>
                    </div>
                    <div class="linecol"><span id="line_position"></span>:<span id="column_position"></span></div>
                    <div class="menu" id="config">
                        <i class="icon-wrench"></i>
                        <ul class="dropdown">
                            <li id='increase_font'>{{ _('Increase Font Size') }}</li>
                            <li id='decrease_font'>{{ _('Decrease Font Size') }}</li>
                        </ul>
                    </div>
                </footer>
            </section>
            <dl class="terminals">
                <dt>{{ _('Input') }}</dt>
                <dd>
                    {{ _('Input Data') }} (stdin):
                    <textarea id="input_data" rows="10">{{ input_data }}</textarea>
                </dd>
                {% if output_data %}
                <dt>{{ _('Output') }}</dt>
                <dd>
                    <pre>{{ output_data }}</pre>
                </dd>
                {% endif %}
                {% if lint_data %}
                <dt>{{ _('Lint') }}</dt>
                <dd>
                    <table id="lint_table">
                        <thead>
                            <tr>
                                <th>{{ _('Position') }}</th>
                                <th>{{ _('Message') }}</th>
                                <th>{{ _('Level') }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for line in lint_data %}
                            <tr>
                                <td>{{ line['line'] }}:{{ line.get('column', 1) }}</td>
                                <td>{{ line['message'] }}</td>
                                <td>{{ line['level'] }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </dd>
                {% endif %}
            </dl>
        </div>
        <aside class="panel_2"></aside>
    </article>
    <form id="run_code" method="post" action="{{ url_for('do_the_thing') }}" style="visibility:hidden"></form>
{% include 'footer.html' %}
<div class="modal_dialog" id="spinner">
    <div class="spinner">
    {%- for i in range(10) %}
        <div></div>
    {%- endfor %}
    </div>
</div>
</body>
{% endblock %}
